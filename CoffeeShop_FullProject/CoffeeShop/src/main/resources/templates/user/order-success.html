<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Đặt hàng thành công | CoffeeShop</title>

    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"/>

    <style>
        body {
            background: #f3ede3;
            font-family: 'Segoe UI', sans-serif;
        }

        .success-wrapper {
            max-width: 780px;
            margin: 40px auto;
        }

        .success-box {
            background: #fff;
            padding: 32px;
            border-radius: 20px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.18);
        }

        .check-icon {
            font-size: 85px;
            color: #4CAF50;
            text-align: center;
            margin-bottom: 10px;
        }

        .payment-icon {
            width: 30px;
            height: 30px;
            margin-right: 6px;
        }

        .order-item {
            padding: 12px 0;
            border-bottom: 1px solid #e0d6ce;
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .btn-coffee {
            background: #6d4c41;
            color: white;
            padding: 10px 22px;
            font-weight: 600;
            border-radius: 12px;
        }

        .btn-coffee:hover {
            background: #5d4037;
            color: white;
        }

        hr {
            border-color: #d9cfc7;
        }

        .title-section {
            font-size: 20px;
            font-weight: 700;
            color: #4e342e;
            margin-bottom: 12px;
        }

        .qr-box img {
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,.15);
        }
    </style>
</head>

<body>

<div th:replace="layout/navbar :: navbar"></div>

<div class="container success-wrapper">

    <div class="success-box">

        <!-- ICON ✔ -->
        <div class="check-icon">✔</div>

        <h2 class="text-center fw-bold">Đặt hàng thành công!</h2>

        <p class="text-center text-muted mt-2">
            Cảm ơn bạn đã mua hàng tại <strong>CoffeeShop</strong>.
        </p>

        <hr>

        <!-- ================= THÔNG TIN ĐƠN HÀNG ================= -->
        <div class="title-section">Thông tin đơn hàng</div>

        <p><strong>Mã đơn:</strong> <span th:text="${order.id}"></span></p>

        <p>
            <strong>Ngày đặt:</strong>
            <span th:text="${#temporals.format(order.orderDate, 'dd/MM/yyyy HH:mm')}"></span>
        </p>

        <p><strong>Khách hàng:</strong> <span th:text="${order.customerName}"></span></p>
        <p><strong>Số điện thoại:</strong> <span th:text="${order.phone}"></span></p>
        <p><strong>Địa chỉ giao hàng:</strong> <span th:text="${order.address}"></span></p>

        <!-- ICON PHƯƠNG THỨC THANH TOÁN -->
        <p class="mt-3">
            <strong>Phương thức thanh toán:</strong>

            <span th:if="${order.paymentMethod == 'COD'}">
                <img src="/img/cod.png" class="payment-icon">
                Thanh toán khi nhận hàng (COD)
            </span>

            <span th:if="${order.paymentMethod == 'BANK'}">
                <img src="/img/bank.png" class="payment-icon">
                Chuyển khoản ngân hàng
            </span>

            <span th:if="${order.paymentMethod == 'MOMO'}">
                <img src="/img/momo.png" class="payment-icon">
                Ví MoMo
            </span>

            <span th:if="${order.paymentMethod == 'VISA'}">
                <img src="/img/visa.png" class="payment-icon">
                Thẻ Visa
            </span>
        </p>

        <hr>

        <!-- ================= SẢN PHẨM ĐÃ ĐẶT ================= -->
        <div class="title-section">Sản phẩm đã đặt</div>

        <div th:each="d : ${order.orderDetails}" class="order-item">

            <div class="fw-bold" th:text="${d.product.name}"></div>

            <div class="text-muted small">
                Size: <span th:text="${d.size}"></span> •
                Đường: <span th:text="${d.sugar}"></span> •
                Đá: <span th:text="${d.ice}"></span>
                <br>

                <span th:if="${d.toppingNames != null}">
                    Topping: <span th:text="${d.toppingNames}"></span>
                </span>
            </div>

            <div class="mt-1">
                Giá:
                <span class="fw-bold text-danger"
                      th:text="${#numbers.formatDecimal(d.price, 0, 'COMMA', 0, 'POINT')} + ' đ'"></span>
                × <span th:text="${d.quantity}"></span>
            </div>

        </div>

        <hr>

        <!-- ================= TỔNG TIỀN ================= -->
        <h4 class="text-end mt-3">
            Tổng thanh toán:
            <span class="text-danger fw-bold"
                  th:text="${#numbers.formatDecimal(order.total, 0, 'COMMA', 0, 'POINT')} + ' đ'"></span>
        </h4>

        <!-- ================= QR BANK ================= -->
        <div class="qr-box text-center mt-4" th:if="${order.paymentMethod == 'BANK'}">
            <h5 class="fw-bold">Quét mã ngân hàng</h5>

            <img src="/img/bank_qr.png" style="width:240px; margin-top:10px;">

            <p class="mt-2 text-muted">
                Chủ tài khoản: <strong>DUONG CHI DU</strong><br>
                STK: <strong>307200588888</strong> – MBBank
            </p>
        </div>

        <!-- ================= QR MOMO ================= -->
        <div class="qr-box text-center mt-4" th:if="${order.paymentMethod == 'MOMO'}">
            <h5 class="fw-bold">Quét mã MoMo</h5>

            <img src="/img/qr_momo.png" style="width:240px; margin-top:10px;">

            <p class="mt-2 text-muted">
                Ví MoMo: <strong>0365184434</strong>
            </p>
        </div>

        <div class="text-center mt-4">
            <a href="/" class="btn btn-coffee">Quay lại trang chủ</a>
        </div>

    </div>

</div>

</body>
</html>
